# Test Azure deployment locally with Python 3.12 (same as Azure)
FROM python:3.12-slim

WORKDIR /app

# Copy only the Azure requirements file
COPY requirements-azure.txt .

# Install dependencies (this will fail if there are conflicts)
RUN pip install --no-cache-dir -r requirements-azure.txt

# Copy application code
COPY . .

# Test that dependencies are installed correctly
RUN python -c "import fastapi, pydantic, langchain_core, langgraph; print('âœ“ All dependencies imported successfully')"

CMD ["gunicorn", "-w", "2", "-k", "uvicorn.workers.UvicornWorker", "api.main:app", "--bind=0.0.0.0:8000"]
